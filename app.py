import streamlit as st
import pandas as pd
import numpy as np

# Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
st.title('ðŸ“Š Streamlit Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°Ð»Ñ‹Ò› Ò›Ð¾ÑÑ‹Ð¼ÑˆÐ°ÑÑ‹')
st.subheader('Kaggle Ð´ÐµÑ€ÐµÐºÑ‚ÐµÑ€Ñ–Ð½Ñ–Ò£ Ð²Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑÑÑ‹')

# 1. Ð”ÐµÑ€ÐµÐºÑ‚ÐµÑ€Ð´Ñ– Ð¶Ò¯ÐºÑ‚ÐµÑƒ (Ñ„Ð°Ð¹Ð» Ð°Ñ‚Ñ‹Ð½ Kaggle-Ð´ÐµÐ½ Ð¶Ò¯ÐºÑ‚ÐµÐ³ÐµÐ½ Ñ„Ð°Ð¹Ð»Ñ‹Ò£Ñ‹Ð·Ð±ÐµÐ½ Ð°ÑƒÑ‹ÑÑ‚Ñ‹Ñ€Ñ‹Ò£Ñ‹Ð·)
FILE_NAME = 'train.csv' # ÐœÑ‹ÑÐ°Ð»Ñ‹: 'train.csv' Ð½ÐµÐ¼ÐµÑÐµ 'data.csv'
try:
    df = pd.read_csv(FILE_NAME)
except FileNotFoundError:
    st.error(f"'{FILE_NAME}' Ñ„Ð°Ð¹Ð»Ñ‹ Ñ‚Ð°Ð±Ñ‹Ð»Ò“Ð°Ð½ Ð¶Ð¾Ò›. ÐžÐ½Ñ‹ Ð±Ñ–Ñ€ Ð±ÑƒÐ¼Ð°Ð´Ð° Ð¾Ñ€Ð½Ð°Ð»Ð°ÑÑ‚Ñ‹Ñ€Ñ‹Ò£Ñ‹Ð·.")
    st.stop()

st.sidebar.header('âš™ï¸ Ð‘Ð°ÑÒ›Ð°Ñ€Ñƒ Ð¿Ð°Ð½ÐµÐ»Ñ–')

# ----------------- 5 Ð¢Ò®Ð Ð›Ð† ÐšÐžÐÐ¢Ð ÐžÐ› -----------------

# ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð» 1: Checkbox (ÒšÒ±ÑÐ±ÐµÐ»Ð³Ñ–) - Ð”ÐµÑ€ÐµÐºÑ‚ÐµÑ€Ð´Ñ– ÐºÓ©Ñ€ÑÐµÑ‚Ñƒ/Ð¶Ð°ÑÑ‹Ñ€Ñƒ
if st.sidebar.checkbox('1. Ð‘Ð°ÑÑ‚Ð°Ð¿Ò›Ñ‹ Ð´ÐµÑ€ÐµÐºÑ‚ÐµÑ€Ð´Ñ– ÐºÓ©Ñ€ÑÐµÑ‚Ñƒ'):
    st.subheader('Ð‘Ð°ÑÑ‚Ð°Ð¿Ò›Ñ‹ Ð´ÐµÑ€ÐµÐºÑ‚ÐµÑ€ Ð¶Ð¸Ñ‹Ð½Ñ‚Ñ‹Ò“Ñ‹')
    st.write(df)
    
# ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð» 2: Multiselect (ÐšÓ©Ð¿ Ñ‚Ð°Ò£Ð´Ð°Ñƒ) - Ð‘Ð°Ò“Ð°Ð½Ð´Ð°Ñ€Ð´Ñ‹ Ñ‚Ð°Ò£Ð´Ð°Ñƒ
st.subheader('Ð¢Ð°Ò£Ð´Ð°Ð»Ò“Ð°Ð½ Ð±Ð°Ò“Ð°Ð½Ð´Ð°Ñ€')
selected_columns = st.multiselect(
    '2. ÒšÐ°Ð½Ð´Ð°Ð¹ Ð±Ð°Ò“Ð°Ð½Ð´Ð°Ñ€Ð´Ñ‹ ÐºÓ©Ñ€ÑÐµÑ‚Ñƒ ÐºÐµÑ€ÐµÐº?',
    options=df.columns.tolist(),
    default=df.columns[:3].tolist() # Ó˜Ð´ÐµÐ¿ÐºÑ– Ð±Ð¾Ð¹Ñ‹Ð½ÑˆÐ° Ð°Ð»Ò“Ð°ÑˆÒ›Ñ‹ 3 Ð±Ð°Ò“Ð°Ð½
)
st.dataframe(df[selected_columns].head())


# ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð» 3: Slider (Ð¡Ñ‹Ñ€Ò“Ñ‹Ñ‚Ð¿Ð°) - Ð¡Ð°Ð½Ð´Ñ‹Ò› Ð¼Ó™Ð½Ð´Ñ– ÑÒ¯Ð·Ñƒ (Ð•Ð³ÐµÑ€ Ð´ÐµÑ€ÐµÐºÑ‚ÐµÑ€Ñ–Ò£Ñ–Ð·Ð´Ðµ 'Age' Ð±Ð°Ò“Ð°Ð½Ñ‹ Ð±Ð¾Ð»ÑÐ°)
# Ð•Ð³ÐµÑ€ ÑÑ–Ð·Ð´Ñ–Ò£ Ð´ÐµÑ€ÐµÐºÑ‚ÐµÑ€Ñ–Ò£Ñ–Ð·Ð´Ðµ 'Age' Ð±Ð°Ò“Ð°Ð½Ñ‹ Ð±Ð¾Ð»Ð¼Ð°ÑÐ°, Ð¾Ð½Ñ‹ Ð±Ð°ÑÒ›Ð° ÑÐ°Ð½Ð´Ñ‹Ò› Ð±Ð°Ò“Ð°Ð½Ò“Ð° Ð°ÑƒÑ‹ÑÑ‚Ñ‹Ñ€Ñ‹Ò£Ñ‹Ð·.
if 'Age' in df.columns and pd.api.types.is_numeric_dtype(df['Age']):
    min_val = int(df['Age'].min())
    max_val = int(df['Age'].max())
    age_filter = st.sidebar.slider(
        '3. Ð–Ð°ÑÑ‚Ñ‹Ò› Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ñ‹Ð½ Ñ‚Ð°Ò£Ð´Ð°Ñƒ (Age)',
        min_value=min_val,
        max_value=max_val,
        value=(min_val, max_val)
    )
    df_filtered_age = df[(df['Age'] >= age_filter[0]) & (df['Age'] <= age_filter[1])]
    st.text(f"Ð–Ð°ÑÑ‹ Ð±Ð¾Ð¹Ñ‹Ð½ÑˆÐ° ÑÒ¯Ð·Ñ–Ð»Ð³ÐµÐ½ Ð´ÐµÑ€ÐµÐºÑ‚ÐµÑ€ ÑÐ°Ð½Ñ‹: {len(df_filtered_age)}")
else:
    st.sidebar.info("3-ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð» Ò¯ÑˆÑ–Ð½ ÑÐ°Ð½Ð´Ñ‹Ò› ÑÒ¯Ð·Ð³Ñ– Ò›Ð¾Ð»Ð¶ÐµÑ‚Ñ–Ð¼ÑÑ–Ð· (Ð±Ð°Ò“Ð°Ð½ Ð¶Ð¾Ò› Ð½ÐµÐ¼ÐµÑÐµ ÑÐ°Ð½Ð´Ñ‹Ò› ÐµÐ¼ÐµÑ).")


# ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð» 4: Selectbox (Ð¢Ñ–Ð·Ñ–Ð¼Ð½ÐµÐ½ Ñ‚Ð°Ò£Ð´Ð°Ñƒ) - Ð¢Ð¾Ð¿Ñ‚Ð°Ñƒ Ð¶Ó™Ð½Ðµ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°
analysis_type = st.sidebar.selectbox(
    '4. ÒšÐ°Ð½Ð´Ð°Ð¹ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°Ð½Ñ‹ ÐºÓ©Ñ€ÑÐµÑ‚Ñƒ ÐºÐµÑ€ÐµÐº?',
    ('Ð–Ð°Ð»Ð¿Ñ‹ ÑÐ¸Ð¿Ð°Ñ‚Ñ‚Ð°Ð¼Ð° (Describe)', 'Ð‘Ð°Ò“Ð°Ð½Ð´Ð°Ñ€ Ð±Ð¾Ð¹Ñ‹Ð½ÑˆÐ° Ð½Ó©Ð»Ð´Ñ–Ðº Ð¼Ó™Ð½Ð´ÐµÑ€')
)
if analysis_type == 'Ð–Ð°Ð»Ð¿Ñ‹ ÑÐ¸Ð¿Ð°Ñ‚Ñ‚Ð°Ð¼Ð° (Describe)':
    st.subheader("Ð”ÐµÑ€ÐµÐºÑ‚ÐµÑ€Ð´Ñ–Ò£ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°Ð»Ñ‹Ò› ÑÐ¸Ð¿Ð°Ñ‚Ñ‚Ð°Ð¼Ð°ÑÑ‹")
    st.write(df.describe())
else:
    st.subheader("ÐÓ©Ð»Ð´Ñ–Ðº (NaN) Ð¼Ó™Ð½Ð´ÐµÑ€ ÑÐ°Ð½Ñ‹")
    st.write(df.isnull().sum())

# ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð» 5: Button (Ð‘Ð°Ñ‚Ñ‹Ñ€Ð¼Ð°) - Ð¢ÐµÐºÑÐµÑ€ÐµÐ´Ñ– Ð½ÐµÐ¼ÐµÑÐµ Ó™Ñ€ÐµÐºÐµÑ‚Ñ‚Ñ– Ð¾Ñ€Ñ‹Ð½Ð´Ð°Ð¹Ð´Ñ‹
if st.button('5. Ð•Ò£ ÐºÓ©Ð¿ Ñ‚Ð°Ñ€Ð°Ð»Ò“Ð°Ð½ Ð¼Ó™Ð½Ð´ÐµÑ€Ð´Ñ– ÐºÓ©Ñ€ÑÐµÑ‚Ñƒ (Mode)'):
    st.text("Ó˜Ñ€ Ð±Ð°Ò“Ð°Ð½Ð´Ð°Ò“Ñ‹ ÐµÒ£ ÐºÓ©Ð¿ Ñ‚Ð°Ñ€Ð°Ð»Ò“Ð°Ð½ Ð¼Ó™Ð½:")
    st.write(df.mode().iloc[0]) # Ð‘Ñ–Ñ€Ñ–Ð½ÑˆÑ– Ñ€ÐµÐ¶Ð¸Ð¼Ñ–Ð½ ÐºÓ©Ñ€ÑÐµÑ‚ÐµÐ¼Ñ–Ð·